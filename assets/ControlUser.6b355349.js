import{af as u,M as p,N as b,O as t,P as l,W as m,R as E,X as h,S as g}from"./index.d936ebe6.js";import{Q as f,c as n}from"./QCard.69c66d1a.js";import{d as y,e as V,f as c,Q as C,i as z,j as k}from"./QPage.bdacc91f.js";import{Q as U}from"./QForm.de03a52b.js";import{_ as w}from"./plugin-vue_export-helper.3db47757.js";import"./QItemLabel.bdb32173.js";const A={data(){return{zona:"",zonaEditar:"",nombreCompleto:"",usuario:"",contrase\u00F1a:"",usuarios:[],nombreCompletoEditar:"",usuarioEditar:"",rolEditar:"",rol:"",contrase\u00F1aEditar:"",usuarioEditandoId:null,columnas:[{name:"nombreCompleto",label:"Nombre Completo",align:"left",field:e=>e.nombreCompleto},{name:"usuario",label:"Usuario",align:"left",field:e=>e.usuario},{name:"rol",label:"Rol",align:"left",field:e=>e.rol},{name:"acciones",label:"Acciones",align:"center"}],mostrarModalAgregar:!1,mostrarModalEditar:!1}},computed:{formValido(){return this.nombreCompleto&&this.usuario&&this.contrase\u00F1a&&this.rol},formValidoEditar(){return this.nombreCompletoEditar&&this.usuarioEditar&&this.contrase\u00F1aEditar&&this.rolEditar}},mounted(){this.cargarUsuarios()},methods:{checkZonaFieldEditar(){this.rolEditar!=="Asesor"&&(this.zonaEditar="")},checkZonaField(){this.rol!=="Asesor"&&(this.zona="")},cargarUsuarios(){fetch("http://localhost:8010/user/").then(e=>e.json()).then(e=>{this.usuarios=e}).catch(e=>{console.error("Error al cargar usuarios:",e)})},submitForm(){const e="1",r={nombreCompleto:this.nombreCompleto,usuario:this.usuario,contrasena:this.contrase\u00F1a,activo:e,rol:this.rol,zona:this.zona?this.zona:""};console.log(r),fetch("http://localhost:8010/user/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(i=>i.json()).then(i=>{console.log("Respuesta del servidor:",i),u.create({message:"Usuario agregado correctamente",color:"positive"})}).catch(i=>{console.error("Error al enviar datos:",i),u.create({message:"Error al agregar usuario",color:"negative"})});const d={id:this.usuarios.length+1,nombreCompleto:this.nombreCompleto,usuario:this.usuario,rol:this.rol};this.usuarios.push(d),this.limpiarFormulario(),this.mostrarModalAgregar=!1},editarUsuario(e){this.nombreCompletoEditar=e.nombreCompleto,this.usuarioEditar=e.usuario,this.rolEditar=e.rol,this.usuarioEditandoId=e.id,this.zonaEditar=e.zona?e.zona:"",this.mostrarModalEditar=!0},editarUsuarioSubmit(){const e={id:this.usuarioEditandoId,nombreCompleto:this.nombreCompletoEditar,usuario:this.usuarioEditar,contrasena:this.contrase\u00F1aEditar,rol:this.rolEditar,zona:this.zonaEditar?this.zonaEditar:"",activo:"1"};console.log("Usuario editado:",e),fetch(`http://localhost:8010/user/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(r=>{r.ok?(this.cargarUsuarios(),this.limpiarFormularioEditar(),this.mostrarModalEditar=!1,this.$q.notify({message:"Usuario editado correctamente",color:"positive"})):this.$q.notify({message:"Error al editar usuario",color:"negative"})}).catch(r=>{console.error("Error al editar usuario:",r),this.$q.notify({message:"Error al editar usuario",color:"negative"})})},eliminarUsuario(e){fetch(`http://localhost:8010/user/${e}`,{method:"DELETE"}).then(r=>{r.ok?(this.usuarios=this.usuarios.filter(d=>d.id!==e),console.log("Usuario eliminado con ID:",e),u.create({message:"Usuario eliminado correctamente",color:"positive"})):(console.error("Error al eliminar usuario con ID:",e),u.create({message:"Error al eliminar usuario",color:"negative"}))}).catch(r=>{console.error("Error al eliminar usuario:",r),u.create({message:"Error al eliminar usuario",color:"negative"})})},limpiarFormulario(){this.nombreCompleto="",this.usuario="",this.contrase\u00F1a="",this.rol=""},limpiarFormularioEditar(){this.nombreCompletoEditar="",this.usuarioEditar="",this.contrase\u00F1aEditar="",this.rol="",this.usuarioEditandoId=null}}},S={class:"row justify-end q-mt-md"},Q={class:"row justify-end q-mt-md"};function I(e,r,d,i,a,s){return p(),b(y,{class:"q-pa-md"},{default:t(()=>[l(m,{onClick:r[0]||(r[0]=o=>a.mostrarModalAgregar=!0),label:"Agregar Usuario",class:"q-mb-md",color:"primary"}),l(C,{modelValue:a.mostrarModalAgregar,"onUpdate:modelValue":r[6]||(r[6]=o=>a.mostrarModalAgregar=o),"content-css":"max-width: 400px;"},{default:t(()=>[l(f,null,{default:t(()=>[l(V,{class:"row items-center q-pa-md"},{default:t(()=>[l(U,{onSubmit:s.submitForm},{default:t(()=>[l(n,{label:"Nombre completo",modelValue:a.nombreCompleto,"onUpdate:modelValue":r[1]||(r[1]=o=>a.nombreCompleto=o),rules:[o=>!!o||"El nombre completo es obligatorio"]},null,8,["modelValue","rules"]),l(n,{label:"Usuario",modelValue:a.usuario,"onUpdate:modelValue":r[2]||(r[2]=o=>a.usuario=o),rules:[o=>!!o||"El usuario es obligatorio"]},null,8,["modelValue","rules"]),l(n,{label:"Contrase\xF1a",modelValue:a.contrase\u00F1a,"onUpdate:modelValue":r[3]||(r[3]=o=>a.contrase\u00F1a=o),type:"password",rules:[o=>!!o||"La contrase\xF1a es obligatoria"]},null,8,["modelValue","rules"]),l(c,{label:"Rol",modelValue:a.rol,"onUpdate:modelValue":r[4]||(r[4]=o=>a.rol=o),options:["administrador","Comercial 1","Comercial 2","Contable","Supervisor","Asesor"],rules:[o=>!!o||"El rol es obligatorio"],onInput:s.checkZonaField},null,8,["modelValue","rules","onInput"]),a.rol==="Asesor"?(p(),b(c,{key:0,label:"Zona",modelValue:a.zona,"onUpdate:modelValue":r[5]||(r[5]=o=>a.zona=o),options:["Zona 1","Zona 2"],rules:[o=>!!o||"La zona es obligatoria"]},null,8,["modelValue","rules"])):E("",!0),h("div",S,[l(m,{type:"submit",label:"Registrar",color:"primary",disable:!s.formValido},null,8,["disable"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(C,{modelValue:a.mostrarModalEditar,"onUpdate:modelValue":r[12]||(r[12]=o=>a.mostrarModalEditar=o),"content-css":"max-width: 400px;"},{default:t(()=>[l(f,null,{default:t(()=>[l(V,{class:"row items-center q-pa-md"},{default:t(()=>[l(U,{onSubmit:s.editarUsuarioSubmit},{default:t(()=>[l(n,{label:"Nombre completo",modelValue:a.nombreCompletoEditar,"onUpdate:modelValue":r[7]||(r[7]=o=>a.nombreCompletoEditar=o),rules:[o=>!!o||"El nombre completo es obligatorio"]},null,8,["modelValue","rules"]),l(n,{label:"Usuario",modelValue:a.usuarioEditar,"onUpdate:modelValue":r[8]||(r[8]=o=>a.usuarioEditar=o),rules:[o=>!!o||"El usuario es obligatorio"]},null,8,["modelValue","rules"]),l(c,{label:"Rol",modelValue:a.rolEditar,"onUpdate:modelValue":r[9]||(r[9]=o=>a.rolEditar=o),options:["administrador","Comercial 1","Comercial 2","Contable","Supervisor","Asesor"],rules:[o=>!!o||"El rol es obligatorio"],onInput:s.checkZonaFieldEditar},null,8,["modelValue","rules","onInput"]),a.rolEditar==="Asesor"?(p(),b(c,{key:0,label:"Zona",modelValue:a.zonaEditar,"onUpdate:modelValue":r[10]||(r[10]=o=>a.zonaEditar=o),options:["Zona 1","Zona 2"],rules:[o=>!!o||"La zona es obligatoria"]},null,8,["modelValue","rules"])):E("",!0),l(n,{label:"Contrase\xF1a",modelValue:a.contrase\u00F1aEditar,"onUpdate:modelValue":r[11]||(r[11]=o=>a.contrase\u00F1aEditar=o),type:"password",rules:[o=>!!o||"La contrase\xF1a es obligatoria"]},null,8,["modelValue","rules"]),h("div",Q,[l(m,{type:"submit",label:"Guardar Cambios",disable:!s.formValidoEditar},null,8,["disable"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(k,{rows:a.usuarios,columns:a.columnas,"row-key":"id",pagination:!0,class:"q-mt-md"},{"body-cell-acciones":t(o=>[l(z,{props:o},{default:t(()=>[l(m,{dense:"",color:"primary",onClick:v=>s.editarUsuario(o.row)},{default:t(()=>[g("Editar")]),_:2},1032,["onClick"]),l(m,{dense:"",color:"negative",onClick:v=>s.eliminarUsuario(o.row.id)},{default:t(()=>[g("Eliminar")]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})}var Z=w(A,[["render",I],["__scopeId","data-v-2579da2c"]]);export{Z as default};
