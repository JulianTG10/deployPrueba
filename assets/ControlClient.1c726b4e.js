import{af as c,M as E,N as Z,O as d,P as i,W as p,X as s,ag as w,R as y,S as j}from"./index.d936ebe6.js";import{Q as F,c as a}from"./QCard.69c66d1a.js";import{d as N,e as B,f as n,Q as T,i as k,j as x}from"./QPage.bdacc91f.js";import{Q as A}from"./QForm.de03a52b.js";import{_ as O}from"./plugin-vue_export-helper.3db47757.js";import"./QItemLabel.bdb32173.js";const P={data(){return{rteFuente:"",porcentajeIva:"",rteIca:"",tipoBase:"",zonasOptions:[],zonaEditar:"",asesoresOptions:[],asesorEditar:"",zona:"",asesorCargo:"",zonas:[],usuariosPorZona:{"Zona 1":[],"Zona 2":[]},nombre:"",ciudad:"",correo:"",direccion:"",telefono:"",nit:"",rnt:"",lmc:"",demas:"",primerDeposito:"",segundoDeposito:"",nombreEditar:"",ciudadEditar:"",correoEditar:"",direccionEditar:"",telefonoEditar:"",nitEditar:"",rntEditar:"",lmcEditar:"",demasEditar:"",primerDepositoEditar:"",segundoDepositoEditar:"",rteFuenteEditar:"",porcentajeIvaEditar:"",rteIcaEditar:"",tipoBaseEditar:"",clienteEditandoId:null,clientes:[],columnas:[{name:"nombre",label:"Nombre",align:"left",field:"nombre"},{name:"ciudad",label:"Ciudad",align:"left",field:"ciudad"},{name:"correo",label:"Correo",align:"left",field:"correo"},{name:"direccion",label:"Direcci\xF3n",align:"left",field:"direccion"},{name:"telefono",label:"Tel\xE9fono",align:"left",field:"telefono"},{name:"nit",label:"NIT",align:"left",field:"nit"},{name:"rnt",label:"RNT",align:"left",field:"rnt"},{name:"lmc",label:"LMC",align:"left",field:"lmc"},{name:"demas",label:"Dem\xE1s",align:"left",field:"demas"},{name:"primerDeposito",label:"Primer Dep\xF3sito",align:"left",field:"primerDeposito"},{name:"segundoDeposito",label:"Segundo Dep\xF3sito",align:"left",field:"segundoDeposito"}],mostrarModalAgregar:!1,mostrarModalEditar:!1}},computed:{formValido(){return this.nombre&&this.ciudad&&this.correo&&this.direccion&&this.telefono&&this.nit&&this.rnt&&this.lmc&&this.demas&&this.primerDeposito&&this.segundoDeposito},formValidoEditar(){return this.nombreEditar&&this.ciudadEditar&&this.correoEditar&&this.direccionEditar&&this.telefonoEditar&&this.nitEditar&&this.rntEditar&&this.lmcEditar&&this.demasEditar&&this.primerDepositoEditar&&this.segundoDepositoEditar}},mounted(){this.cargarZonasYUsuarios(),this.cargarClientes()},methods:{async cargarAsesoresPorZona(){try{if(console.log("Cargando asesores por zona..."),!this.zonaEditar){console.log("No se ha seleccionado ninguna zona."),this.asesoresOptions=[];return}console.log("Zona seleccionada:",this.zonaEditar);const l=await fetch("http://localhost:8010/user/zona/zona");if(!l.ok)throw new Error("Error al cargar los asesores por zona");const m=(await l.json()).filter(e=>e.zona===this.zonaEditar).map(e=>({value:e.id,label:e.nombreCompleto}));this.asesoresOptions=m,console.log("Asesores por zona cargados exitosamente:",this.asesoresOptions),this.asesorEditar=""}catch(l){console.error("Error al cargar asesores por zona:",l)}},async cargarZonasYUsuarios(){try{console.log("Cargando zonas y usuarios...");const l=await fetch("http://localhost:8010/user/zona/zona");if(!l.ok)throw new Error("Error al cargar las zonas y usuarios");const o=await l.json(),r={"Zona 1":[],"Zona 2":[]};o.forEach(m=>{const e=m.zona;r[e]&&r[e].push({value:m.id,label:m.nombreCompleto})}),this.zonas=Object.keys(r),this.usuariosPorZona=r,console.log("Zonas y usuarios cargados exitosamente:",this.zonas,this.usuariosPorZona)}catch(l){console.error("Error al cargar zonas y usuarios:",l)}},cargarClientes(){fetch("http://localhost:8010/cliente").then(l=>l.json()).then(l=>{const o=l.map(r=>{var m,e,u,t,h,b,g,V,f,v,_,C,q,D,I,z,U;return{id:r.id,nombre:(m=r.nombre)!=null?m:"",ciudad:(e=r.ciudad)!=null?e:"",correo:(u=r.correo)!=null?u:"",direccion:(t=r.direccion)!=null?t:"",telefono:(h=r.telefono)!=null?h:"",nit:(b=r.nit)!=null?b:"",rnt:(g=r.rnt)!=null?g:"",lmc:(V=r.lmc)!=null?V:"",demas:(f=r.demas)!=null?f:"",primerDeposito:(v=r.primerDeposito)!=null?v:"",segundoDeposito:(_=r.segundoDeposito)!=null?_:"",zona:(C=r.zona)!=null?C:"",asesor:(q=r.asesor)!=null?q:"",rteFuente:(D=r.rteFuente)!=null?D:"",porcentajeIva:(I=r.porcentajeIva)!=null?I:"",rteIca:(z=r.rteIca)!=null?z:"",tipoBase:(U=r.tipoBase)!=null?U:""}});console.log(o),this.clientes=o}).catch(l=>{console.error("Error al obtener los datos:",l)})},submitForm(){const l=this.zona?this.usuariosPorZona[this.zona][0].value:null,o={nombre:this.nombre,ciudad:this.ciudad?this.ciudad:null,correo:this.correo?this.correo:null,direccion:this.direccion?this.direccion:null,telefono:this.telefono?this.telefono:null,nit:this.nit?this.nit:null,rnt:this.rnt?this.rnt:null,lmc:this.lmc,demas:this.demas,primerDeposito:this.primerDeposito?this.primerDeposito:null,segundoDeposito:this.segundoDeposito?this.segundoDeposito:null,zona:this.zona?this.zona:null,asesor:l,tipoBase:this.tipoBase,porcentajeIva:this.porcentajeIva?this.porcentajeIva:null,rteFuente:this.rteFuente?this.rteFuente:null,rteIca:this.rteIca?this.rteIca:null};console.log("newClient",o),fetch("http://localhost:8010/cliente/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(r=>r.json()).then(r=>{c.create({message:"Cliente agregado correctamente",color:"positive"}),this.cargarClientes(),this.limpiarFormulario(),this.mostrarModalAgregar=!1}).catch(r=>{console.error("Error al agregar cliente:",r),c.create({message:"Error al agregar cliente",color:"negative"})})},editarCliente(l){const o=`http://localhost:8010/user/${l.asesor}`;fetch(o).then(r=>r.json()).then(r=>{l.nombreCompleto=r.nombreCompleto,l.usuario=r.usuario,l.contrasena=r.contrasena,l.activo=r.activo,l.rol=r.rol,l.zona=r.zona,this.zonaEditar=l.zona,this.asesorEditar=l.nombreCompleto,this.nombreEditar=l.nombre,this.ciudadEditar=l.ciudad,this.correoEditar=l.correo,this.direccionEditar=l.direccion,this.telefonoEditar=l.telefono,this.nitEditar=l.nit,this.rntEditar=l.rnt,this.lmcEditar=l.lmc,this.demasEditar=l.demas,this.primerDepositoEditar=l.primerDeposito,this.segundoDepositoEditar=l.segundoDeposito,this.rteFuenteEditar=l.rteFuente,this.porcentajeIvaEditar=l.porcentajeIva,this.rteIcaEditar=l.rteIca,this.tipoBaseEditar=l.tipoBase,this.clienteEditandoId=l.id,this.mostrarModalEditar=!0}).catch(r=>{console.error("Error al obtener la informaci\xF3n del cliente:",r)})},editarClienteSubmit(){const l=this.zonaEditar?this.usuariosPorZona[this.zonaEditar][0].value:null,o={id:this.clienteEditandoId,nombre:this.nombreEditar,ciudad:this.ciudadEditar?this.ciudadEditar:null,correo:this.correoEditar?this.correoEditar:null,direccion:this.direccionEditar?this.direccionEditar:null,telefono:this.telefonoEditar?this.telefonoEditar:null,nit:this.nitEditar?this.nitEditar:null,rnt:this.rntEditar?this.rntEditar:null,lmc:this.lmcEditar,demas:this.demasEditar,primerDeposito:this.primerDepositoEditar,segundoDeposito:this.segundoDepositoEditar,zona:this.zonaEditar?this.zonaEditar:null,rteFuente:this.rteFuenteEditar?this.rteFuenteEditar:null,porcentajeIva:this.porcentajeIvaEditar?this.porcentajeIvaEditar:null,rteIca:this.rteIcaEditar?this.rteIcaEditar:null,tipoBase:this.tipoBaseEditar?this.tipoBaseEditar:null,asesor:l};fetch(`http://localhost:8010/cliente/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(r=>{r.ok?(c.create({message:"Cliente editado correctamente",color:"positive"}),this.cargarClientes(),this.limpiarFormularioEditar(),this.mostrarModalEditar=!1):(console.error("Error al editar cliente:",r.statusText),c.create({message:"Error al editar cliente",color:"negative"}))}).catch(r=>{console.error("Error al editar cliente:",r),c.create({message:"Error al editar cliente",color:"negative"})})},eliminarCliente(l){fetch(`http://localhost:8010/cliente/${l}`,{method:"DELETE"}).then(o=>{o.ok?(c.create({message:"Cliente eliminado correctamente",color:"positive"}),this.clientes=this.clientes.filter(r=>r.id!==l)):(console.error("Error al eliminar cliente:",o.statusText),c.create({message:"Error al eliminar cliente",color:"negative"}))}).catch(o=>{console.error("Error al eliminar cliente:",o),c.create({message:"Error al eliminar cliente",color:"negative"})})},limpiarFormulario(){this.nombre="",this.ciudad="",this.correo="",this.direccion="",this.telefono="",this.nit="",this.rnt="",this.lmc="",this.demas="",this.primerDeposito="",this.segundoDeposito="",this.rteFuente="",this.porcentajeIva="",this.rteIca="",this.tipoBase=""},limpiarFormularioEditar(){this.nombreEditar="",this.ciudadEditar="",this.correoEditar="",this.direccionEditar="",this.telefonoEditar="",this.nitEditar="",this.rntEditar="",this.lmcEditar="",this.demasEditar="",this.primerDepositoEditar="",this.segundoDepositoEditar="",this.rteFuenteEditar="",this.porcentajeIvaEditar="",this.rteIcaEditar="",this.tipoBaseEditar="",this.clienteEditandoId=null}}},M={class:"q-ma-md"},Q={class:"q-gutter-md"},S={class:"row q-col-gutter-md"},R={class:"col"},L={class:"col"},G={class:"row q-col-gutter-md"},J={class:"col"},Y={class:"col"},W={class:"row q-col-gutter-md"},X={class:"col"},H={class:"col"},K={class:"row q-col-gutter-md"},$={class:"col"},oo={class:"col"},eo={class:"row q-col-gutter-md"},to={class:"col"},so={class:"col"},lo={class:"row q-col-gutter-md"},io={class:"col"},ro={class:"col"},ao={key:0,class:"row q-col-gutter-md"},no={class:"col"},mo={class:"col"},uo={class:"col"},co={class:"row q-col-gutter-md"},po={class:"col"},ho={class:"col"},Eo={class:"row justify-end q-mt-md"},bo={class:"q-ma-md"},go={class:"q-gutter-md"},Vo={class:"row q-col-gutter-md"},fo={class:"col"},vo={class:"col"},_o={class:"row q-col-gutter-md"},Co={class:"col"},qo={class:"col"},Do={class:"row q-col-gutter-md"},Io={class:"col"},zo={class:"col"},Uo={class:"row q-col-gutter-md"},wo={class:"col"},yo={class:"col"},jo={class:"row q-col-gutter-md"},Fo={class:"col"},Bo={class:"col"},To={class:"row q-col-gutter-md"},Ao={class:"col"},Zo={class:"col"},No={key:0,class:"row q-col-gutter-md"},ko={class:"col"},xo={class:"col"},Oo={class:"col"},Po={class:"row q-col-gutter-md"},Mo={class:"col"},Qo={class:"col"},So={class:"row justify-end q-mt-md"};function Ro(l,o,r,m,e,u){return E(),Z(N,{class:"q-pa-md"},{default:d(()=>[i(p,{onClick:o[0]||(o[0]=t=>e.mostrarModalAgregar=!0),label:"Agregar Cliente",class:"q-mb-md",color:"primary"}),i(T,{modelValue:e.mostrarModalAgregar,"onUpdate:modelValue":o[18]||(o[18]=t=>e.mostrarModalAgregar=t),"content-css":"max-width: 800px;"},{default:d(()=>[i(F,null,{default:d(()=>[i(B,{class:"q-pa-md"},{default:d(()=>[s("div",M,[i(A,{onSubmit:u.submitForm},{default:d(()=>[s("div",Q,[s("div",S,[s("div",R,[i(a,{label:"Nombre",modelValue:e.nombre,"onUpdate:modelValue":o[1]||(o[1]=t=>e.nombre=t),rules:[t=>!!t||"El nombre es obligatorio"],class:"q-mb-md"},null,8,["modelValue","rules"])]),s("div",L,[i(n,{modelValue:e.ciudad,"onUpdate:modelValue":o[2]||(o[2]=t=>e.ciudad=t),label:"Ciudad",class:"q-mb-md",options:["BOGOTA","CALI"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue"])])]),s("div",G,[s("div",J,[i(a,{label:"Correo",modelValue:e.correo,"onUpdate:modelValue":o[3]||(o[3]=t=>e.correo=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",Y,[i(a,{label:"Direcci\xF3n",modelValue:e.direccion,"onUpdate:modelValue":o[4]||(o[4]=t=>e.direccion=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",W,[s("div",X,[i(a,{label:"Tel\xE9fono",modelValue:e.telefono,"onUpdate:modelValue":o[5]||(o[5]=t=>e.telefono=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",H,[i(a,{label:"NIT",modelValue:e.nit,"onUpdate:modelValue":o[6]||(o[6]=t=>e.nit=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",K,[s("div",$,[i(a,{label:"RNT",modelValue:e.rnt,"onUpdate:modelValue":o[7]||(o[7]=t=>e.rnt=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",oo,[i(a,{label:"LMC",modelValue:e.lmc,"onUpdate:modelValue":o[8]||(o[8]=t=>e.lmc=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",eo,[s("div",to,[i(a,{label:"Dem\xE1s",modelValue:e.demas,"onUpdate:modelValue":o[9]||(o[9]=t=>e.demas=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",so,[i(a,{label:"1er Dep\xF3sito",modelValue:e.primerDeposito,"onUpdate:modelValue":o[10]||(o[10]=t=>e.primerDeposito=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",lo,[s("div",io,[i(a,{label:"2do Dep\xF3sito",modelValue:e.segundoDeposito,"onUpdate:modelValue":o[11]||(o[11]=t=>e.segundoDeposito=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",ro,[i(n,{modelValue:e.tipoBase,"onUpdate:modelValue":o[12]||(o[12]=t=>e.tipoBase=t),label:"Tipo de Base",options:["Comisi\xF3n","Descuento"],class:"q-mb-md"},null,8,["modelValue"])])]),e.tipoBase==="Comisi\xF3n"?(E(),w("div",ao,[s("div",no,[i(a,{type:"number",label:"Porcentaje de IVA",modelValue:e.porcentajeIva,"onUpdate:modelValue":o[13]||(o[13]=t=>e.porcentajeIva=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",mo,[i(n,{modelValue:e.rteFuente,"onUpdate:modelValue":o[14]||(o[14]=t=>e.rteFuente=t),label:"RTE Fuente",options:["10","11"],class:"q-mb-md"},null,8,["modelValue"])]),s("div",uo,[i(n,{modelValue:e.rteIca,"onUpdate:modelValue":o[15]||(o[15]=t=>e.rteIca=t),label:"RTE ICA",options:["0.966","1.4"],class:"q-mb-md"},null,8,["modelValue"])])])):y("",!0),s("div",co,[s("div",po,[i(n,{modelValue:e.zona,"onUpdate:modelValue":o[16]||(o[16]=t=>e.zona=t),label:"Zona",options:e.zonas,class:"q-mb-md"},null,8,["modelValue","options"])]),s("div",ho,[i(n,{modelValue:e.asesorCargo,"onUpdate:modelValue":o[17]||(o[17]=t=>e.asesorCargo=t),label:"Asesor Cargo",options:e.usuariosPorZona[e.zona],class:"q-mb-md"},null,8,["modelValue","options"])])])]),s("div",Eo,[i(p,{type:"submit",label:"Registrar",color:"primary"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(T,{modelValue:e.mostrarModalEditar,"onUpdate:modelValue":o[36]||(o[36]=t=>e.mostrarModalEditar=t),"content-css":"max-width: 800px;"},{default:d(()=>[i(F,null,{default:d(()=>[i(B,{class:"q-pa-md"},{default:d(()=>[s("div",bo,[i(A,{onSubmit:u.editarClienteSubmit},{default:d(()=>[s("div",go,[s("div",Vo,[s("div",fo,[i(a,{label:"Nombre",modelValue:e.nombreEditar,"onUpdate:modelValue":o[19]||(o[19]=t=>e.nombreEditar=t),rules:[t=>!!t||"El nombre es obligatorio"],class:"q-mb-md"},null,8,["modelValue","rules"])]),s("div",vo,[i(n,{modelValue:e.ciudadEditar,"onUpdate:modelValue":o[20]||(o[20]=t=>e.ciudadEditar=t),label:"Ciudad",class:"q-mb-md",options:["BOGOTA","CALI"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue"])])]),s("div",_o,[s("div",Co,[i(a,{label:"Correo",modelValue:e.correoEditar,"onUpdate:modelValue":o[21]||(o[21]=t=>e.correoEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",qo,[i(a,{label:"Direcci\xF3n",modelValue:e.direccionEditar,"onUpdate:modelValue":o[22]||(o[22]=t=>e.direccionEditar=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",Do,[s("div",Io,[i(a,{label:"Tel\xE9fono",modelValue:e.telefonoEditar,"onUpdate:modelValue":o[23]||(o[23]=t=>e.telefonoEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",zo,[i(a,{label:"NIT",modelValue:e.nitEditar,"onUpdate:modelValue":o[24]||(o[24]=t=>e.nitEditar=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",Uo,[s("div",wo,[i(a,{label:"RNT",modelValue:e.rntEditar,"onUpdate:modelValue":o[25]||(o[25]=t=>e.rntEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",yo,[i(a,{label:"LMC",modelValue:e.lmcEditar,"onUpdate:modelValue":o[26]||(o[26]=t=>e.lmcEditar=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",jo,[s("div",Fo,[i(a,{label:"Dem\xE1s",modelValue:e.demasEditar,"onUpdate:modelValue":o[27]||(o[27]=t=>e.demasEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",Bo,[i(a,{label:"1er Dep\xF3sito",modelValue:e.primerDepositoEditar,"onUpdate:modelValue":o[28]||(o[28]=t=>e.primerDepositoEditar=t),class:"q-mb-md"},null,8,["modelValue"])])]),s("div",To,[s("div",Ao,[i(a,{label:"2do Dep\xF3sito",modelValue:e.segundoDepositoEditar,"onUpdate:modelValue":o[29]||(o[29]=t=>e.segundoDepositoEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",Zo,[i(n,{modelValue:e.tipoBaseEditar,"onUpdate:modelValue":o[30]||(o[30]=t=>e.tipoBaseEditar=t),label:"Tipo de Base",options:["Comisi\xF3n","Descuento"],class:"q-mb-md"},null,8,["modelValue"])])]),e.tipoBaseEditar==="Comisi\xF3n"?(E(),w("div",No,[s("div",ko,[i(a,{type:"number",label:"Porcentaje de IVA",modelValue:e.porcentajeIvaEditar,"onUpdate:modelValue":o[31]||(o[31]=t=>e.porcentajeIvaEditar=t),class:"q-mb-md"},null,8,["modelValue"])]),s("div",xo,[i(n,{modelValue:e.rteFuenteEditar,"onUpdate:modelValue":o[32]||(o[32]=t=>e.rteFuenteEditar=t),label:"RTE Fuente",options:[10,11],class:"q-mb-md"},null,8,["modelValue"])]),s("div",Oo,[i(n,{modelValue:e.rteIcaEditar,"onUpdate:modelValue":o[33]||(o[33]=t=>e.rteIcaEditar=t),label:"RTE ICA",options:["0.966","1.4"],class:"q-mb-md"},null,8,["modelValue"])])])):y("",!0),s("div",Po,[s("div",Mo,[i(n,{modelValue:e.zonaEditar,"onUpdate:modelValue":[o[34]||(o[34]=t=>e.zonaEditar=t),u.cargarAsesoresPorZona],label:"Zona",options:["Zona 1","Zona 2"],"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Qo,[i(n,{modelValue:e.asesorEditar,"onUpdate:modelValue":o[35]||(o[35]=t=>e.asesorEditar=t),label:"Asesor",options:e.asesoresOptions,"emit-value":"","map-options":"","hide-selected":!1},null,8,["modelValue","options"])])])]),s("div",So,[i(p,{type:"submit",label:"Guardar Cambios",color:"primary"})])]),_:1},8,["onSubmit"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(x,{rows:e.clientes,columns:[...e.columnas,{name:"acciones",label:"Acciones",align:"center"}],"row-key":"id",pagination:!0,class:"q-mt-md"},{"body-cell-acciones":d(t=>[i(k,{props:t,class:"fit"},{default:d(()=>[i(p,{dense:"",color:"primary",onClick:h=>u.editarCliente(t.row),style:{"margin-right":"3px"}},{default:d(()=>[j("Editar")]),_:2},1032,["onClick"]),i(p,{dense:"",color:"negative",onClick:h=>u.eliminarCliente(t.row.id),style:{"margin-left":"3px"}},{default:d(()=>[j("Eliminar")]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})}var Ho=O(P,[["render",Ro],["__scopeId","data-v-7ef8770a"]]);export{Ho as default};
